async function fetchResult(option) {
  try {
    const url = `https://script.google.com/macros/s/AKfycbzaPUGGWZiR8JHykI7VEskwMsis9CbBeSdK-bfipzyFcGuRse7V3LDQ7ruaiv40FVdk7A/exec?yesOrNo=${option}`;
    const response = await fetch(url, {
      method: 'GET',
      mode: 'cors',
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }

    const result = await response.json(); // Expecting JSON array
    updateTable(result);
    document.getElementById('result').classList.remove('error');
  } catch (error) {
    console.error('Error fetching result:', error);
    document.getElementById('result').innerText = 'Error occurred. Please try again.';
    document.getElementById('result').classList.add('error');
  }
}

function updateTable(seatAssignments) {
  const tableBody = document.getElementById('table-body');
  tableBody.innerHTML = ''; // Clear previous results

  const names = ['Julius', 'Noah', 'Caden'];

  names.forEach((name, index) => {
    const row = document.createElement('tr');
    const nameCell = document.createElement('td');
    const seatCell = document.createElement('td');

    nameCell.innerText = name;
    seatCell.innerText = seatAssignments[index] || 'Not Assigned';

    row.appendChild(nameCell);
    row.appendChild(seatCell);
    tableBody.appendChild(row);
  });
}
